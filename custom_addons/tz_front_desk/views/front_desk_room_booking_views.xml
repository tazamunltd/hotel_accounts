<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="fd_view_room_booking_form" model="ir.ui.view">
            <field name="name">tz.room.booking.form.frontdesk</field>
            <field name="model">room.booking</field>
            <field name="arch" type="xml">
                <form string="Front Desk">
                    <sheet>
                        <div class="row g-2">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="card mb-2 shadow-sm">
                                    <div class="card-header py-1 px-2">
                                        <i class="fa fa-bed m-1"/>
                                        <span class="fw-bold">Guest Information</span>
                                    </div>
                                    <div class="card-body py-1 px-2">
                                        <div class="row g-2">
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label for="company_id" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="company_id"/>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label for="name" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="name"/>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label for="date_order" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="date_order" readonly="1"/>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label for="partner_id" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="partner_id"
                                                           domain="[('is_company', '=', is_agent), ('user_ids', '=', False), ('id', 'not in', company_ids_)]"
                                                           required="True"/>
                                                    <field name="company_ids_" invisible="1"/>
                                                    <field name="is_agent" invisible="1"/>
                                                    <field name="state" invisible="1"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="nationality" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="nationality" force_save="1" required="True"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="reference_contact_" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="reference_contact_"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="ref_id_bk" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="ref_id_bk"/>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="card mb-2 shadow-sm">
                                    <div class="card-header py-1 px-2">
                                        <i class="fa fa-cog m-1"/>
                                        <span class="fw-bold">Booking Details</span>
                                    </div>
                                    <div class="card-body py-1 px-2">
                                        <div class="row g-2">
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="rate_code" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="rate_code" required="not use_price"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="meal_pattern" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="meal_pattern" required="not use_meal_price"/>
                                                </div>
                                            </div>
                                            <!--<div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="market_segment" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="market_segment" required="not use_meal_price"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="source_business" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="source_business" required="not use_meal_price"/>
                                                </div>
                                            </div>-->

                                            <!--<div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="price_pax" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="price_pax"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="price_child" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="price_child"/>
                                                </div>
                                            </div>-->
                                        </div>
                                        <div class="row g-2 mt-1">
                                            <div class="col-lg-4 col-md-4 col-sm-12">
                                                <div class="card mb-2 shadow-sm">
                                                    <div class="card-header py-1 px-2">
                                                        <i class="fa fa-percent m-1"></i>
                                                        <span class="fw-bold">Room Price Details</span>
                                                    </div>
                                                    <div class="card-body p-2">
                                                        <div class="row">
                                                            <!-- Use Room Price -->
                                                            <div class="form-group col-6 mb-1">
                                                                <field name="use_price" string="Use Room Price"
                                                                       readonly="state in ('check_out', 'no_show', 'check_out')"
                                                                       force_save="1"
                                                                       style="height: 24px; padding: 2px 6px;"/>
                                                                <label for="use_price" class="form-label small">Use Room
                                                                    Price
                                                                </label>
                                                            </div>

                                                            <!-- Room Price -->
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="use_price == False">
                                                                <label for="room_price" class="form-label small">Room
                                                                    Price
                                                                </label>
                                                                <field name="room_price" string="Room Price"
                                                                       readonly="state in ('check_out', 'no_show', 'check_out')"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"
                                                                       style="height: 24px; padding: 2px 6px;"/>
                                                            </div>

                                                            <!-- Discount or Percentage -->
                                                            <!-- Percentage -->
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="room_is_percentage == False or use_price == False">
                                                                <label for="room_discount"
                                                                       class="form-label small">Discount
                                                                    (Percentage)
                                                                </label>
                                                                <field name="room_discount" widget="percentage"
                                                                       readonly="state in ('check_out')"
                                                                       digits="[16,2]"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>

                                                            <!-- Amount -->
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="room_is_percentage == True or use_price == False">
                                                                <label for="room_discount"
                                                                       class="form-label small">Room Discount
                                                                    (Amount)
                                                                </label>
                                                                <field name="room_discount" digits="[16,2]"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>

                                                            <!-- Is Amount -->
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="room_is_percentage == True or use_price == False">
                                                                <field name="room_is_amount"
                                                                       string="Room Discount As Amount"
                                                                       readonly="state in ('check_out', 'no_show')"
                                                                       force_save="1"
                                                                       style="height: 24px; padding: 2px 6px;"/>
                                                                <label for="room_is_amount"
                                                                       class="form-label small">Is Amount
                                                                </label>
                                                            </div>

                                                            <!-- Is Percentage -->
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="room_is_amount == True or use_price == False">
                                                                <field name="room_is_percentage"
                                                                       string="Room Discount As Percentage"
                                                                       readonly="state in ('check_out', 'no_show')"
                                                                       force_save="1"
                                                                       style="height: 24px; padding: 2px 6px;"/>
                                                                <label for="room_is_percentage"
                                                                       class="form-label small">Is Percentage?
                                                                </label>
                                                            </div>

                                                            <!-- Amount Selection -->
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="use_price == False or room_is_amount == False">
                                                                <label for="room_amount_selection"
                                                                       class="form-label small">Amount Selection
                                                                </label>
                                                                <field name="room_amount_selection"
                                                                       string="Room Amount Selection"
                                                                       readonly="state in ('check_out', 'no_show')"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"
                                                                       style="height: 24px; padding: 2px 6px;"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Meals Discount Details -->
                                            <div class="col-lg-4 col-md-4 col-sm-12">
                                                <div class="card mb-2 shadow-sm">
                                                    <div class="card-header py-1 px-2">
                                                        <i class="fa fa-cutlery m-1"></i>
                                                        <span class="fw-bold">Meals Price Details</span>
                                                    </div>
                                                    <div class="card-body p-2">
                                                        <div class="row">
                                                            <div class="form-group col-6 mb-1">
                                                                <field name="use_meal_price"
                                                                       readonly="state in ('check_out')"
                                                                       force_save="1"/>
                                                                <label for="use_meal_price"
                                                                       class="form-label small">use_priceMeal Price
                                                                </label>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="use_meal_price == False">
                                                                <label for="meal_price" class="form-label small">Meal
                                                                    Price
                                                                </label>
                                                                <field name="meal_price"
                                                                       readonly="state in ('check_out')"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="use_meal_price == False">
                                                                <label for="meal_child_price"
                                                                       class="form-label small">Child Meal Price
                                                                </label>
                                                                <field name="meal_child_price"
                                                                       readonly="state in ('check_out')"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="not meal_is_percentage or use_meal_price == False">
                                                                <label for="meal_discount"
                                                                       class="form-label small">Meal Discount
                                                                    (Percentage)
                                                                </label>
                                                                <field name="meal_discount" widget="percentage"
                                                                       readonly="state in ('check_out')"
                                                                       digits="[16,2]"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="meal_is_percentage or use_meal_price == False">
                                                                <label for="meal_discount"
                                                                       class="form-label small">Meal Discount
                                                                    (Amount)
                                                                </label>
                                                                <field name="meal_discount" digits="[16,2]"
                                                                       readonly="state in ('check_out')"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="meal_is_percentage == True or use_meal_price == False">
                                                                <field name="meal_is_amount"
                                                                       readonly="state in ('check_out')"
                                                                       force_save="1"/>
                                                                <label for="meal_is_amount"
                                                                       class="form-label small">Is Amount
                                                                </label>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="meal_is_amount == True or use_meal_price == False">
                                                                <field name="meal_is_percentage" force_save="1"/>
                                                                <label for="meal_is_percentage"
                                                                       class="form-label small">Is Percentage
                                                                </label>
                                                            </div>
                                                            <div class="form-group col-6 mb-1"
                                                                 invisible="meal_is_amount == False or use_meal_price == False">
                                                                <label for="meal_amount_selection"
                                                                       class="form-label small">Amount Selection
                                                                </label>
                                                                <field name="meal_amount_selection"
                                                                       readonly="state in ('check_out')"
                                                                       class="form-control form-control-sm"
                                                                       force_save="1"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mb-2 shadow-sm">
                                    <div class="card-header py-1 px-2">
                                        <i class="fa fa-users m-1"/>
                                        <span class="fw-bold">Room Availability Results</span>
                                    </div>
                                    <div class="card-body py-1 px-2">
                                        <div class="row g-2">
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="room_list" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="room_list"
                                                           options="{'no_open': True, 'no_create': True}" required="1"/>
                                                    <field name="unavailable_room_ids" invisible="1"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="no_of_nights" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="no_of_nights" readonly="false"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="checkout_date" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="checkout_date"/>
                                                </div>
                                            </div>
                                            <div class="row g-2" invisible="not room_list">
                                                <!-- Room Type Name -->
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label for="room_type_name" class="form-label small"/>
                                                    </div>
                                                    <div class="form-control form-control-sm">
                                                        <field name="room_type_name"/>
                                                    </div>
                                                </div>

                                                <!-- Suite -->
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label for="suite" class="form-label small"/>
                                                    </div>
                                                    <div class="form-control form-control-sm">
                                                        <field name="suite"/>
                                                    </div>
                                                </div>

                                                <!-- No Smoking -->
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label for="no_smoking" class="form-label small"/>
                                                    </div>
                                                    <div class="form-control form-control-sm">
                                                        <field name="no_smoking"/>
                                                    </div>
                                                </div>

                                            </div>
                                            <hr/>

                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="adult_count" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="adult_count"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="child_count" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="child_count"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="infant_count" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="infant_count"/>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="extra_beds" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="extra_beds"/>
                                                </div>
                                            </div>
                                            <hr/>

                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="companions" class="form-label small"/>
                                                </div>
                                                <div class="form-control form-control-sm">
                                                    <field name="companions" widget="many2many_tags"
                                                           domain="[('is_company', '=', is_agent), ('user_ids', '=', False), ('id', 'not in', company_ids_)]"
                                                           readonly="state in ('check_out')"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <notebook>
                                    <page string="Adults">
                                        <field name="adult_ids"
                                               readonly="state in ('check_out')"
                                               options="{'invisible': [('adult_count', '=', 0)]}">
                                            <tree string="Adults" editable="top">
                                                <field name="room_sequence"/>
                                                <field name="room_type_id" readonly="1"
                                                       options="{'no_open': True}"/>
                                                <field name="room_id" readonly="1" options="{'no_open': True}"/>
                                                <field name="first_name"/>
                                                <field name="last_name"/>
                                                <field name="nationality"/>
                                                <field name="birth_date"/>
                                                <field name="passport_number"/>
                                                <field name="id_number"/>
                                                <field name="visa_number"/>
                                                <field name="id_type"/>
                                                <field name="phone_number"/>
                                                <field name="relation"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Children">
                                        <field name="child_ids"
                                               readonly="state in ('check_out')"
                                               options="{'invisible': [('child_count', '=', 0)]}">
                                            <tree string="Children" editable="top">
                                                <field name="room_sequence"/>
                                                <field name="room_type_id" readonly="1"
                                                       options="{'no_open': True}"/>
                                                <field name="room_id" readonly="1" options="{'no_open': True}"/>
                                                <field name="first_name"/>
                                                <field name="last_name"/>
                                                <field name="nationality"/>
                                                <field name="birth_date"/>
                                                <field name="passport_number"/>
                                                <field name="id_number"/>
                                                <field name="visa_number"/>
                                                <field name="id_type"/>
                                                <field name="phone_number"/>
                                                <field name="relation"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Infant">
                                        <field name="infant_ids"
                                               readonly="state in ('check_out')"
                                               options="{'invisible': [('infant_count', '=', 0)]}">
                                            <tree string="Infant" editable="top">
                                                <field name="room_sequence"/>
                                                <field name="room_type_id" readonly="1"
                                                       options="{'no_open': True}"/>
                                                <field name="room_id" readonly="1" options="{'no_open': True}"/>
                                                <field name="first_name"/>
                                                <field name="last_name"/>
                                                <field name="nationality"/>
                                                <field name="birth_date"/>
                                                <field name="passport_number"/>
                                                <field name="id_number"/>
                                                <field name="visa_number"/>
                                                <field name="id_type"/>
                                                <field name="phone_number"/>
                                                <field name="relation"/>
                                            </tree>
                                        </field>
                                    </page>
                                </notebook>
                            </div>
                        </div>
                    </sheet>
                    <div class="oe_chatter" style="margin-top: 20px;">
                        <field name="message_ids" widget="mail_thread"/>
                        <field name="activity_ids" widget="mail_activity"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- Action Window -->
        <!-- Action 1: Front Desk View -->
        <record id="fd_action_room_booking" model="ir.actions.act_window">
            <field name="name">Front Desk Bookings</field>
            <field name="res_model">room.booking</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="fd_view_room_booking_form"/>
            <field name="context">
                {
                'default_state': 'check_in',
                'front_desk': True
                }
            </field>
        </record>


        <!-- Tree View -->
        <record id="fd_view_room_booking_tree" model="ir.ui.view">
            <field name="name">tz.room.booking.tree.frontdesk</field>
            <field name="model">room.booking</field>
            <field name="arch" type="xml">
                <tree string="Walking">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="date_order"/>
                    <field name="checkin_date"/>
                    <field name="checkout_date"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <!-- Action 2: Booking Admin View (could use same or different views) -->
        <record id="fd_action_room_booking_list" model="ir.actions.act_window">
            <field name="name">Bookings List</field>
            <field name="res_model">room.booking</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="fd_view_room_booking_tree"/>
        </record>

        <record id="view_room_booking_search_inherit" model="ir.ui.view">
            <field name="name">room.booking.search.view.inherit</field>
            <field name="model">room.booking</field>
            <field name="inherit_id" ref="hotel_management_odoo.view_room_booking_search"/>
            <field name="arch" type="xml">
                <xpath expr="//search" position="inside">
                    <filter string="In House" name="in_house" domain="[('state', '=', 'check_in')]"/>
                </xpath>
            </field>
        </record>

        <record id="room_booking_action_tree" model="ir.actions.act_window">
            <field name="name">In-House Guests</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">room.booking</field>
            <field name="view_mode">tree,kanban,pivot,graph,calendar,form</field>
            <field name="domain">[('show_in_tree', '=', True)]</field>
            <field name="context">{'search_default_in_house': 1}</field>
            <field name="view_id" ref="hotel_management_odoo.room_booking_view_tree"/>
        </record>

        <!-- Menu Item -->
        <!-- Menu 1: Under Front Desk -->
        <menuitem id="menu_fd_root" name="New Front Desk"/>

        <menuitem id="menu_front_desk_parent" parent="menu_fd_root" name="Front Desk"/>

        <menuitem id="menu_fd_room_booking" name="Walking"
                  parent="menu_front_desk_parent"
                  action="fd_action_room_booking"
                  sequence="1"/>

        <menuitem id="menu_admin_room_booking" name="In-House Guests"
                  parent="menu_front_desk_parent"
                  action="room_booking_action_tree"
                  sequence="2"/>

    </data>
</odoo>